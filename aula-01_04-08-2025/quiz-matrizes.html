<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Tipos de Matrizes</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- KaTeX for LaTeX rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" xintegrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzOKtGpFDEIta90aaVJaMbKAciRDJvj3AWM" crossorigin="anonymous"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .katex-display {
            margin: 1.5em 0;
        }
        .option-label {
            transition: all 0.2s ease-in-out;
        }
        .option-label:hover {
            background-color: #f0f9ff; /* light blue on hover */
        }
        .has-[:checked]:not(.correct):not(.incorrect) {
             background-color: #eef2ff; /* indigo-100 */
             border-color: #6366f1; /* indigo-500 */
             color: #312e81; /* indigo-900 */
        }
        .correct {
            background-color: #dcfce7 !important; /* green-200 */
            border-color: #22c55e !important; /* green-500 */
            color: #15803d !important; /* green-700 */
        }
        .incorrect {
            background-color: #fee2e2 !important; /* red-200 */
            border-color: #ef4444 !important; /* red-500 */
            color: #b91c1c !important; /* red-700 */
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex items-center justify-center min-h-screen p-4">

    <div id="quiz-container" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-2xl">

        <div id="quiz-start">
            <h1 class="text-2xl sm:text-3xl font-bold text-center text-slate-900 mb-4">Quiz: Tipos de Matrizes</h1>
            <p class="text-center text-slate-600 mb-6">Você terá 30 segundos por questão. Teste seus conhecimentos identificando 20 tipos de matrizes. Boa sorte!</p>
            <div class="mb-4">
                <label for="student-name" class="block text-sm font-medium text-slate-700 mb-1">Seu Nome Completo:</label>
                <input type="text" id="student-name" class="w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="Digite seu nome aqui">
                <p id="name-error" class="text-red-500 text-sm mt-1 hidden">Por favor, insira seu nome para começar.</p>
            </div>
            <button id="start-btn" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                Começar o Quiz
            </button>
        </div>

        <div id="quiz-main" class="hidden">
            <div class="flex justify-between items-center mb-4 gap-4">
                <h2 class="text-xl font-bold text-slate-900">Questão <span id="question-number"></span> de 20</h2>
                <div class="flex items-center gap-4">
                    <div class="text-lg font-semibold bg-red-100 text-red-800 px-3 py-1 rounded-md">Tempo: <span id="time-left">30</span>s</div>
                    <div class="text-lg font-semibold bg-indigo-100 text-indigo-800 px-3 py-1 rounded-md">Pontos: <span id="score">0</span></div>
                </div>
            </div>

            <p class="text-slate-700 text-lg mb-4">Que tipo de matriz é esta?</p>

            <div id="matrix-display" class="text-center text-2xl bg-slate-50 p-4 rounded-lg border border-slate-200"></div>

            <div id="options-container" class="mt-6 space-y-3"></div>

            <div id="feedback" class="mt-6 p-4 rounded-lg text-center font-medium hidden"></div>

            <div class="mt-6">
                <button id="next-btn" class="w-full bg-slate-700 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-800 transition-colors duration-300 hidden">Próxima Questão</button>
            </div>
        </div>

        <div id="quiz-end" class="hidden text-center">
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Quiz Finalizado!</h1>
            <p id="final-greeting" class="text-xl text-slate-600 mb-4"></p>
            <p class="text-lg text-slate-600">Sua pontuação final foi:</p>
            <div class="text-5xl font-bold text-indigo-600 my-4" id="final-score"></div>
            <a id="send-result-btn" href="#" target="_blank" class="block w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 mb-3">
                Enviar Resultado
            </a>
            <button id="restart-btn" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                Tentar Novamente
            </button>
        </div>

    </div>

    <script>
        // --- DATA ---
        const quizData = [
            {
                matrix: "\\begin{pmatrix} 5 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 9 \\end{pmatrix}",
                options: ["Matriz Identidade", "Matriz Diagonal", "Matriz Nula", "Matriz Linha"],
                correctAnswers: ["Matriz Diagonal"],
                explanation: "É uma Matriz Diagonal, pois é uma matriz quadrada onde todos os elementos fora da diagonal principal são nulos."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}",
                options: ["Matriz Diagonal", "Matriz Identidade", "Matriz Escalar", "Todas as anteriores"],
                correctAnswers: ["Matriz Diagonal", "Matriz Identidade", "Matriz Escalar", "Todas as anteriores"],
                explanation: "Correto! Ela é Identidade (diagonal com 1s), Diagonal (elementos não nulos só na diagonal) e Escalar (diagonal com elementos iguais). Portanto, 'Todas as anteriores' é a melhor resposta."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 2 & 3 \\end{pmatrix}",
                options: ["Matriz Coluna", "Matriz Quadrada", "Matriz Linha", "Matriz 3x1"],
                correctAnswers: ["Matriz Linha"],
                explanation: "É uma Matriz Linha, pois possui apenas uma linha."
            },
            {
                matrix: "\\begin{pmatrix} 7 \\\\ -1 \\\\ 4 \\end{pmatrix}",
                options: ["Matriz Linha", "Matriz Coluna", "Matriz 1x3", "Matriz Diagonal"],
                correctAnswers: ["Matriz Coluna"],
                explanation: "É uma Matriz Coluna, pois possui apenas uma coluna."
            },
            {
                matrix: "\\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}",
                options: ["Matriz Quadrada", "Matriz Identidade", "Matriz Nula", "Matriz Coluna"],
                correctAnswers: ["Matriz Nula"],
                explanation: "É uma Matriz Nula, pois todos os seus elementos são iguais a zero."
            },
            {
                matrix: "\\begin{pmatrix} 8 & 1 \\\\ 3 & 5 \\end{pmatrix}",
                options: ["Matriz Quadrada", "Matriz Retangular", "Matriz Identidade", "Matriz Nula"],
                correctAnswers: ["Matriz Quadrada"],
                explanation: "É uma Matriz Quadrada, pois o número de linhas (2) é igual ao número de colunas (2)."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 2 & 3 \\\\ 0 & 4 & 5 \\\\ 0 & 0 & 6 \\end{pmatrix}",
                options: ["Matriz Triangular Inferior", "Matriz Diagonal", "Matriz Triangular Superior", "Matriz Identidade"],
                correctAnswers: ["Matriz Triangular Superior"],
                explanation: "É uma Matriz Triangular Superior, pois todos os elementos abaixo da diagonal principal são nulos."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 3 & 0 \\\\ 4 & 5 & 6 \\end{pmatrix}",
                options: ["Matriz Triangular Superior", "Matriz Triangular Inferior", "Matriz Diagonal", "Matriz Identidade"],
                correctAnswers: ["Matriz Triangular Inferior"],
                explanation: "É uma Matriz Triangular Inferior, pois todos os elementos acima da diagonal principal são nulos."
            },
            {
                matrix: "\\begin{pmatrix} 2 & 0 \\\\ 0 & 9 \\end{pmatrix}",
                options: ["Matriz Identidade", "Matriz Diagonal", "Matriz Escalar", "Matriz Linha"],
                correctAnswers: ["Matriz Diagonal"],
                explanation: "É uma Matriz Diagonal, pois é uma matriz quadrada 2x2 com elementos nulos fora da diagonal principal."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 2 \\\\ 3 & 4 \\\\ 5 & 6 \\end{pmatrix}",
                options: ["Matriz Quadrada", "Matriz Retangular", "Matriz Coluna", "Matriz 2x3"],
                correctAnswers: ["Matriz Retangular"],
                explanation: "É uma Matriz Retangular, pois o número de linhas (3) é diferente do número de colunas (2)."
            },
            {
                matrix: "\\begin{pmatrix} 7 \\end{pmatrix}",
                options: ["Matriz Linha", "Matriz Coluna", "Matriz Quadrada", "Todas as anteriores"],
                correctAnswers: ["Matriz Linha", "Matriz Coluna", "Matriz Quadrada", "Todas as anteriores"],
                explanation: "Pegadinha! Uma matriz 1x1 pode ser considerada Linha, Coluna e Quadrada ao mesmo tempo. 'Todas as anteriores' é a melhor resposta."
            },
            {
                matrix: "\\begin{pmatrix} 5 & 0 & 0 \\\\ 0 & 5 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix}",
                options: ["Matriz Identidade", "Matriz Diagonal", "Matriz Escalar", "Todas as anteriores"],
                correctAnswers: ["Matriz Diagonal", "Matriz Escalar", "Todas as anteriores"],
                explanation: "É uma Matriz Escalar (diagonal com elementos iguais) e também uma Matriz Diagonal. 'Todas as anteriores' seria correto se ela fosse identidade, o que não é. As opções 'Diagonal' e 'Escalar' estão corretas."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 2 & 3 \\\\ 4 & 5 & 6 \\end{pmatrix}",
                options: ["Matriz Quadrada", "Matriz 3x2", "Matriz Retangular", "Matriz Coluna"],
                correctAnswers: ["Matriz Retangular"],
                explanation: "É uma Matriz Retangular 2x3, pois o número de linhas (2) é diferente do número de colunas (3)."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}",
                options: ["Apenas Matriz Quadrada", "Apenas Matriz Diagonal", "Apenas Matriz Identidade", "Todas as anteriores"],
                correctAnswers: ["Todas as anteriores"],
                explanation: "É uma Matriz Identidade, que por definição também é Diagonal e Quadrada. Portanto, 'Todas as anteriores' é a resposta mais completa."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 5 & 8 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}",
                options: ["Matriz Linha", "Matriz Coluna", "Matriz Quadrada", "Matriz Nula"],
                correctAnswers: ["Matriz Quadrada"],
                explanation: "Pegadinha! Apesar de ter muitos zeros e uma única linha não nula, ela ainda é uma Matriz Quadrada (3x3). Não se encaixa na definição de Matriz Linha ou Nula."
            },
            {
                matrix: "\\begin{pmatrix} 9 & 5 & 2 & 1 \\end{pmatrix}",
                options: ["Matriz Coluna", "Matriz Linha", "Matriz 1x1", "Matriz Vetor"],
                correctAnswers: ["Matriz Linha"],
                explanation: "É uma Matriz Linha, pois possui apenas uma linha."
            },
            {
                matrix: "\\begin{pmatrix} 8 \\\\ 1 \\end{pmatrix}",
                options: ["Matriz Linha", "Matriz Coluna", "Matriz Quadrada", "Matriz 1x2"],
                correctAnswers: ["Matriz Coluna"],
                explanation: "É uma Matriz Coluna, pois possui apenas uma coluna."
            },
            {
                matrix: "\\begin{pmatrix} 1 & 2 & 3 & 4 \\\\ 5 & 6 & 7 & 8 \\end{pmatrix}",
                options: ["Matriz Quadrada", "Matriz Retangular", "Matriz 4x2", "Matriz Linha"],
                correctAnswers: ["Matriz Retangular"],
                explanation: "É uma Matriz Retangular, pois o número de linhas (2) é diferente do número de colunas (4)."
            },
            {
                matrix: "\\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}",
                options: ["Matriz Nula", "Matriz Linha", "Ambas estão corretas", "Nenhuma está correta"],
                correctAnswers: ["Matriz Nula", "Matriz Linha", "Ambas estão corretas"],
                explanation: "Correto! É uma Matriz Nula (todos elementos são zero) e também uma Matriz Linha (possui uma única linha). 'Ambas estão corretas' é a melhor opção."
            },
            {
                matrix: "\\begin{pmatrix} 4 & 0 & 0 \\\\ 1 & 0 & 0 \\\\ 8 & 0 & 0 \\end{pmatrix}",
                options: ["Matriz Coluna", "Matriz Linha", "Matriz Quadrada", "Matriz Nula"],
                correctAnswers: ["Matriz Quadrada"],
                explanation: "Pegadinha! Embora apenas a primeira coluna tenha valores não nulos, a matriz tem 3 linhas e 3 colunas, o que a define como uma Matriz Quadrada."
            }
        ];

        // --- DOM ELEMENTS ---
        const startContainer = document.getElementById('quiz-start');
        const mainContainer = document.getElementById('quiz-main');
        const endContainer = document.getElementById('quiz-end');

        const studentNameInput = document.getElementById('student-name');
        const nameErrorEl = document.getElementById('name-error');
        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const sendResultBtn = document.getElementById('send-result-btn');

        const questionNumberEl = document.getElementById('question-number');
        const scoreEl = document.getElementById('score');
        const timeLeftEl = document.getElementById('time-left');
        const matrixDisplayEl = document.getElementById('matrix-display');
        const optionsContainerEl = document.getElementById('options-container');
        const feedbackEl = document.getElementById('feedback');
        const finalGreetingEl = document.getElementById('final-greeting');
        const finalScoreEl = document.getElementById('final-score');

        // --- STATE ---
        let studentName = '';
        let currentQuestionIndex = 0;
        let score = 0;
        let shuffledQuestions = [];
        let timerId;
        let timeLeft = 30;

        // --- FUNCTIONS ---

        function startQuiz() {
            studentName = studentNameInput.value.trim();
            if (studentName === '') {
                nameErrorEl.classList.remove('hidden');
                return;
            }
            nameErrorEl.classList.add('hidden');

            startContainer.classList.add('hidden');
            mainContainer.classList.remove('hidden');
            endContainer.classList.add('hidden');

            shuffledQuestions = [...quizData].sort(() => Math.random() - 0.5);
            currentQuestionIndex = 0;
            score = 0;
            scoreEl.textContent = score;
            loadQuestion();
        }

        function loadQuestion() {
            clearInterval(timerId);
            timeLeft = 30;
            timeLeftEl.textContent = timeLeft;

            feedbackEl.classList.add('hidden');
            nextBtn.classList.add('hidden');
            nextBtn.textContent = 'Próxima Questão';

            const currentQuestion = shuffledQuestions[currentQuestionIndex];

            questionNumberEl.textContent = currentQuestionIndex + 1;

            katex.render(currentQuestion.matrix, matrixDisplayEl, {
                throwOnError: false,
                displayMode: true
            });

            optionsContainerEl.innerHTML = '';
            // Shuffle the options for the current question
            const shuffledOptions = [...currentQuestion.options].sort(() => Math.random() - 0.5);

            shuffledOptions.forEach((option, index) => {
                const optionId = `option${index}`;
                const optionEl = document.createElement('div');
                optionEl.innerHTML = `
                    <input type="radio" name="option" value="${option}" id="${optionId}" class="hidden">
                    <label for="${optionId}" class="option-label block w-full p-4 border-2 border-slate-300 rounded-lg cursor-pointer text-slate-700 font-medium hover:border-indigo-400">
                        ${option}
                    </label>
                `;
                optionsContainerEl.appendChild(optionEl);
            });

            startTimer();
        }

        function startTimer() {
             timerId = setInterval(() => {
                timeLeft--;
                timeLeftEl.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    handleTimeUp();
                }
            }, 1000);
        }

        function handleTimeUp() {
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            document.querySelectorAll('input[name="option"]').forEach(input => {
                input.disabled = true;
                const label = input.nextElementSibling;
                if (currentQuestion.correctAnswers.includes(input.value)) {
                    label.classList.add('correct');
                }
            });

            feedbackEl.textContent = "O tempo acabou! " + currentQuestion.explanation;
            feedbackEl.className = 'mt-6 p-4 rounded-lg text-center font-medium bg-yellow-100 text-yellow-800';
            feedbackEl.classList.remove('hidden');
            nextBtn.classList.remove('hidden');

            if (currentQuestionIndex === shuffledQuestions.length - 1) {
                nextBtn.textContent = 'Ver Resultado Final';
            }
        }

        function checkAnswer(selectedInput) {
            clearInterval(timerId); // Stop the timer as soon as an answer is given
            const userAnswer = selectedInput.value;
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            const isCorrect = currentQuestion.correctAnswers.includes(userAnswer);

            document.querySelectorAll('input[name="option"]').forEach(input => {
                input.disabled = true;
                const label = input.nextElementSibling;
                if (currentQuestion.correctAnswers.includes(input.value)) {
                    label.classList.add('correct');
                }
            });

            if (isCorrect) {
                score++;
                scoreEl.textContent = score;
                feedbackEl.textContent = "Correto! " + currentQuestion.explanation;
                feedbackEl.className = 'mt-6 p-4 rounded-lg text-center font-medium bg-green-100 text-green-800';
            } else {
                feedbackEl.textContent = "Incorreto. " + currentQuestion.explanation;
                feedbackEl.className = 'mt-6 p-4 rounded-lg text-center font-medium bg-red-100 text-red-800';
                selectedInput.nextElementSibling.classList.add('incorrect');
            }

            feedbackEl.classList.remove('hidden');
            nextBtn.classList.remove('hidden');

            if (currentQuestionIndex === shuffledQuestions.length - 1) {
                nextBtn.textContent = 'Ver Resultado Final';
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < shuffledQuestions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            mainContainer.classList.add('hidden');
            endContainer.classList.remove('hidden');

            finalGreetingEl.textContent = `Parabéns, ${studentName}!`;
            finalScoreEl.textContent = `${score} / ${shuffledQuestions.length}`;

            const resultText = `O aluno ${studentName} acertou ${score} de ${shuffledQuestions.length} questões no quiz de matrizes.`;
            const encodedResult = encodeURIComponent(btoa(resultText));

            const whatsappLink = `https://wa.me/553171244499?text=${encodedResult}`;
            sendResultBtn.setAttribute('href', whatsappLink);
        }

        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', startQuiz);
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', () => {
            endContainer.classList.add('hidden');
            startContainer.classList.remove('hidden');
            studentNameInput.value = '';
        });

        optionsContainerEl.addEventListener('change', (event) => {
            if (event.target.name === 'option') {
                checkAnswer(event.target);
            }
        });

    </script>
</body>
</html>
